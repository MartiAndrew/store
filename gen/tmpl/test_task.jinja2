import pytest
from taskiq import TaskiqState

from common.logging.log_models import LogData

from {{ service }}.tasks.{{ task_name }} import {{ task_name }}


@pytest.mark.anyio
async def test_{{ task_name }}(taskiq_state: TaskiqState):
    """Тест воркера."""
    task = await {{ task_name }}.kiq(log_data=LogData())
    task_res = await task.wait_result()
    assert not task_res.is_err
    assert task_res.return_value
